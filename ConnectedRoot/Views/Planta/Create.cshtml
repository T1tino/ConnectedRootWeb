@model ConnectedRoot.Models.Planta

@{
    ViewData["Title"] = "Registrar Nueva Planta";
}

<h2>ğŸŒ± Registrar Nueva Planta</h2>

@if (!string.IsNullOrEmpty(ViewBag.Error))
{
    <div class="alert alert-danger">
        @ViewBag.Error
    </div>
}

@if (!string.IsNullOrEmpty(ViewBag.NombreZona))
{
    <div class="alert alert-info">
        <strong>Registrando planta en la zona:</strong> @ViewBag.NombreZona
    </div>
}

<form asp-action="Create" method="post">
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5>InformaciÃ³n de la Planta</h5>
                </div>
                <div class="card-body">
                    <div class="form-group mb-3">
                        <label asp-for="ZonaId" class="form-label">Zona de Cultivo</label>
                        <select asp-for="ZonaId" class="form-control" required>
                            <option value="">Seleccionar zona...</option>
                            @foreach (var zona in ViewBag.ZonasConHuerto)
                            {
                                @if (ViewBag.ZonaSeleccionada?.ToString() == zona.ZonaId)
                                {
                                    <option value="@zona.ZonaId" selected>@zona.Display</option>
                                }
                                else
                                {
                                    <option value="@zona.ZonaId">@zona.Display</option>
                                }
                            }
                        </select>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                <label asp-for="NombreComun" class="form-label">Nombre ComÃºn</label>
                                <input asp-for="NombreComun" class="form-control" placeholder="Ej: Tomate cherry" required />
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                <label asp-for="NombreCientifico" class="form-label">Nombre CientÃ­fico</label>
                                <input asp-for="NombreCientifico" class="form-control" placeholder="Ej: Solanum lycopersicum" />
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                <label asp-for="TipoCultivo" class="form-label">Tipo de Cultivo</label>
                                <select asp-for="TipoCultivo" class="form-control" required>
                                    <option value="">Seleccionar tipo...</option>
                                    <option value="Hortaliza">ğŸ¥• Hortaliza</option>
                                    <option value="Frutal">ğŸ Frutal</option>
                                    <option value="AromÃ¡tica">ğŸŒ¿ AromÃ¡tica</option>
                                    <option value="Legumbre">ğŸ«˜ Legumbre</option>
                                    <option value="Cereal">ğŸŒ¾ Cereal</option>
                                    <option value="Ornamental">ğŸŒº Ornamental</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group mb-3">
                                <label asp-for="Estado" class="form-label">Estado Actual</label>
                                <select asp-for="Estado" class="form-control" required>
                                    <option value="Germinando" selected>ğŸŒ± Germinando</option>
                                    <option value="Crecimiento">ğŸŒ¿ Crecimiento</option>
                                    <option value="FloraciÃ³n">ğŸŒ¸ FloraciÃ³n</option>
                                    <option value="FructificaciÃ³n">ğŸ… FructificaciÃ³n</option>
                                    <option value="Cosecha">ğŸ§º Cosecha</option>
                                    <option value="Finalizado">âœ… Finalizado</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="FechaSiembra" class="form-label">Fecha de Siembra</label>
                        <input asp-for="FechaSiembra" type="date" class="form-control" value="@DateTime.Now.ToString("yyyy-MM-dd")" required />
                    </div>

                    <div class="form-group mb-3">
                        <label asp-for="Notas" class="form-label">Notas de Cuidado</label>
                        <textarea asp-for="Notas" class="form-control" rows="4" placeholder="Anota observaciones sobre la planta: ubicaciÃ³n especÃ­fica, cuidados especiales, tratamientos aplicados, etc."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h6>ğŸ’¡ GuÃ­a de Cuidados</h6>
                </div>
                <div class="card-body">
                    <div id="cuidados-hortaliza" class="d-none">
                        <strong>ğŸ¥• Hortalizas:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: Regular, evitar encharcamiento</li>
                            <li>â˜€ï¸ Sol: 6-8 horas diarias</li>
                            <li>ğŸŒ¡ï¸ Temperatura: 18-25Â°C</li>
                            <li>ğŸ§ª pH: 6.0-7.0</li>
                            <li>ğŸŒ± Cosecha: 60-90 dÃ­as</li>
                        </ul>
                    </div>
                    
                    <div id="cuidados-frutal" class="d-none">
                        <strong>ğŸ Frutales:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: Profundo pero espaciado</li>
                            <li>â˜€ï¸ Sol: 8+ horas diarias</li>
                            <li>ğŸŒ¡ï¸ Temperatura: Variable segÃºn especie</li>
                            <li>âœ‚ï¸ Poda: SegÃºn temporada</li>
                            <li>ğŸ Cosecha: SegÃºn madurez</li>
                        </ul>
                    </div>
                    
                    <div id="cuidados-aromÃ¡tica" class="d-none">
                        <strong>ğŸŒ¿ AromÃ¡ticas:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: Moderado, no excesivo</li>
                            <li>â˜€ï¸ Sol: 4-6 horas diarias</li>
                            <li>ğŸŒ¡ï¸ Temperatura: 15-25Â°C</li>
                            <li>âœ‚ï¸ Cosecha: Hojas jÃ³venes</li>
                            <li>ğŸŒ¿ Poda: Estimula crecimiento</li>
                        </ul>
                    </div>

                    <div id="cuidados-legumbre" class="d-none">
                        <strong>ğŸ«˜ Legumbres:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: Moderado durante crecimiento</li>
                            <li>â˜€ï¸ Sol: 6+ horas diarias</li>
                            <li>ğŸŒ¡ï¸ Temperatura: 15-22Â°C</li>
                            <li>ğŸŒ± GerminaciÃ³n: 7-10 dÃ­as</li>
                            <li>ğŸ§ª pH: 6.5-7.0</li>
                        </ul>
                    </div>

                    <div id="cuidados-cereal" class="d-none">
                        <strong>ğŸŒ¾ Cereales:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: Abundante en germinaciÃ³n</li>
                            <li>â˜€ï¸ Sol: Pleno sol</li>
                            <li>ğŸŒ¡ï¸ Temperatura: 16-24Â°C</li>
                            <li>ğŸŒ± Ciclo: 90-120 dÃ­as</li>
                            <li>ğŸ§ª pH: 6.0-7.5</li>
                        </ul>
                    </div>

                    <div id="cuidados-ornamental" class="d-none">
                        <strong>ğŸŒº Ornamentales:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ’§ Riego: SegÃºn especie</li>
                            <li>â˜€ï¸ Sol: Variable</li>
                            <li>ğŸŒ¡ï¸ Temperatura: 15-25Â°C</li>
                            <li>âœ‚ï¸ Poda: Para forma y floraciÃ³n</li>
                            <li>ğŸŒ¸ FloraciÃ³n: SegÃºn estaciÃ³n</li>
                        </ul>
                    </div>
                    
                    <div class="alert alert-success mt-3">
                        <small><strong>ğŸ“‹ Tip:</strong> MantÃ©n un registro fotogrÃ¡fico del crecimiento para monitorear el progreso.</small>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header bg-warning">
                    <h6>ğŸ“… Cronograma TÃ­pico</h6>
                </div>
                <div class="card-body">
                    <div id="cronograma-hortaliza" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 5-10 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 30-45 dÃ­as</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 45-60 dÃ­as</p>
                        <p><strong>ğŸ§º Cosecha:</strong> 60-90 dÃ­as</p>
                    </div>

                    <div id="cronograma-frutal" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 10-21 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 1-2 aÃ±os</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 2-3 aÃ±os</p>
                        <p><strong>ğŸ Primera cosecha:</strong> 3-5 aÃ±os</p>
                    </div>

                    <div id="cronograma-aromÃ¡tica" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 7-14 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 20-30 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Primera cosecha:</strong> 30-45 dÃ­as</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 60-90 dÃ­as</p>
                    </div>

                    <div id="cronograma-legumbre" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 7-10 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 40-60 dÃ­as</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 60-80 dÃ­as</p>
                        <p><strong>ğŸ«˜ Cosecha:</strong> 90-120 dÃ­as</p>
                    </div>

                    <div id="cronograma-cereal" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 7-14 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 60-90 dÃ­as</p>
                        <p><strong>ğŸŒ¾ Espigado:</strong> 90-110 dÃ­as</p>
                        <p><strong>ğŸ§º Cosecha:</strong> 120-150 dÃ­as</p>
                    </div>

                    <div id="cronograma-ornamental" class="cronograma-content d-none">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 10-21 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 30-60 dÃ­as</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 60-120 dÃ­as</p>
                        <p><strong>ğŸŒº FloraciÃ³n plena:</strong> Variable</p>
                    </div>

                    <div id="cronograma-default" class="cronograma-content">
                        <p><strong>ğŸŒ± GerminaciÃ³n:</strong> 7-14 dÃ­as</p>
                        <p><strong>ğŸŒ¿ Crecimiento:</strong> 30-45 dÃ­as</p>
                        <p><strong>ğŸŒ¸ FloraciÃ³n:</strong> 45-60 dÃ­as</p>
                        <p><strong>ğŸ§º Cosecha:</strong> 60-90 dÃ­as</p>
                        <small class="text-muted">*Los tiempos varÃ­an segÃºn la especie</small>
                    </div>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header bg-secondary text-white">
                    <h6>ğŸŒ± Plantas Sugeridas</h6>
                </div>
                <div class="card-body">
                    <div id="sugerencias-hortaliza" class="sugerencias-content d-none">
                        <strong>FÃ¡ciles para principiantes:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ¥¬ Lechuga</li>
                            <li>ğŸ¥• RÃ¡banos</li>
                            <li>ğŸŒ¿ Espinacas</li>
                            <li>ğŸ¥’ Pepinos</li>
                            <li>ğŸ… Tomates cherry</li>
                        </ul>
                    </div>

                    <div id="sugerencias-aromÃ¡tica" class="sugerencias-content d-none">
                        <strong>AromÃ¡ticas populares:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸŒ¿ Albahaca</li>
                            <li>ğŸŒ¿ Perejil</li>
                            <li>ğŸŒ¿ Cilantro</li>
                            <li>ğŸŒ¿ OrÃ©gano</li>
                            <li>ğŸŒ¿ Menta</li>
                        </ul>
                    </div>

                    <div id="sugerencias-frutal" class="sugerencias-content d-none">
                        <strong>Frutales para macetas:</strong>
                        <ul class="list-unstyled mt-2">
                            <li>ğŸ“ Fresas</li>
                            <li>ğŸ« ArÃ¡ndanos</li>
                            <li>ğŸ‹ Limones (enanos)</li>
                            <li>ğŸ‡ Uvas</li>
                            <li>ğŸ¥ Kiwi</li>
                        </ul>
                    </div>

                    <div class="alert alert-info mt-3">
                        <small><strong>ğŸ’¡ Consejo:</strong> Comienza con plantas fÃ¡ciles de cuidar si eres principiante.</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="form-group mt-3">
        <input type="submit" value="ğŸŒ± Registrar Planta" class="btn btn-success btn-lg" />
        <a asp-action="Index" class="btn btn-secondary btn-lg">Cancelar</a>
    </div>
</form>

<script>
// Mostrar cuidados especÃ­ficos segÃºn el tipo seleccionado
document.getElementById('TipoCultivo').addEventListener('change', function() {
    // Ocultar todas las guÃ­as
    document.querySelectorAll('[id^="cuidados-"]').forEach(el => el.classList.add('d-none'));
    document.querySelectorAll('.cronograma-content').forEach(el => el.classList.add('d-none'));
    document.querySelectorAll('.sugerencias-content').forEach(el => el.classList.add('d-none'));
    
    // Mostrar la guÃ­a correspondiente
    const tipo = this.value.toLowerCase();
    
    // Mostrar cuidados especÃ­ficos
    const elementoCuidados = document.getElementById('cuidados-' + tipo);
    if (elementoCuidados) {
        elementoCuidados.classList.remove('d-none');
    }
    
    // Mostrar cronograma especÃ­fico
    const elementoCronograma = document.getElementById('cronograma-' + tipo);
    if (elementoCronograma) {
        elementoCronograma.classList.remove('d-none');
    } else {
        // Mostrar cronograma por defecto si no hay especÃ­fico
        document.getElementById('cronograma-default').classList.remove('d-none');
    }
    
    // Mostrar sugerencias especÃ­ficas
    const elementoSugerencias = document.getElementById('sugerencias-' + tipo);
    if (elementoSugerencias) {
        elementoSugerencias.classList.remove('d-none');
    }
});

// Autocompletar nombres comunes basados en el tipo
document.getElementById('TipoCultivo').addEventListener('change', function() {
    const nombreComunInput = document.getElementById('NombreComun');
    const tipo = this.value;
    
    // Limpiar placeholder
    nombreComunInput.placeholder = "Nombre de la planta...";
    
    // Establecer placeholder especÃ­fico segÃºn tipo
    switch(tipo) {
        case 'Hortaliza':
            nombreComunInput.placeholder = "Ej: Tomate, Lechuga, Zanahoria...";
            break;
        case 'Frutal':
            nombreComunInput.placeholder = "Ej: Fresa, LimÃ³n, Uva...";
            break;
        case 'AromÃ¡tica':
            nombreComunInput.placeholder = "Ej: Albahaca, Perejil, Cilantro...";
            break;
        case 'Legumbre':
            nombreComunInput.placeholder = "Ej: Frijol, Garbanzo, Lenteja...";
            break;
        case 'Cereal':
            nombreComunInput.placeholder = "Ej: MaÃ­z, Trigo, Avena...";
            break;
        case 'Ornamental':
            nombreComunInput.placeholder = "Ej: Rosa, Geranio, Petunia...";
            break;
    }
});

// Inicializar con cronograma por defecto
document.addEventListener('DOMContentLoaded', function() {
    document.getElementById('cronograma-default').classList.remove('d-none');
});
</script>

<style>
.card {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border: none;
}

.card-header {
    border-bottom: none;
    font-weight: 600;
}

.form-label {
    font-weight: 600;
    color: #495057;
}

.alert {
    border: none;
    border-radius: 8px;
}

.btn {
    border-radius: 6px;
    font-weight: 500;
}

.btn-lg {
    padding: 0.75rem 2rem;
}

ul.list-unstyled li {
    padding: 2px 0;
    font-size: 0.9rem;
}

#cronograma-default p, 
.cronograma-content p {
    margin-bottom: 8px;
    font-size: 0.9rem;
}

.sugerencias-content li {
    background-color: #f8f9fa;
    padding: 4px 8px;
    margin: 2px 0;
    border-radius: 4px;
}
</style>